SELECT sag6.name,gname,ou_name,IFNULL(GROUP_CONCAT(jan),'') AS 'jan','Jan to June' AS 'section',sag6.FB,
IFNULL(GROUP_CONCAT(feb),'') AS 'feb',
IFNULL(GROUP_CONCAT(mar),'') AS 'mar',
IFNULL(GROUP_CONCAT(apr),'') AS 'apr',
IFNULL(GROUP_CONCAT(may),'') AS 'may',
IFNULL(GROUP_CONCAT(jun),'') AS 'jun'
FROM 
(
	SELECT sag5.name,gname,CASE WHEN gname LIKE 'CHCs' THEN 3 WHEN gname LIKE 'Sub District Hospital' THEN 2 WHEN gname LIKE 'District Hospital' THEN 1 END AS seq,grade,ou_name, CASE WHEN mn=1 THEN grade END AS 'jan',sag5.FB,
	CASE WHEN mn=2 THEN grade END AS 'feb',
	CASE WHEN mn=3 THEN grade END AS 'mar',
	CASE WHEN mn=4 THEN grade END AS 'apr',
	CASE WHEN mn=5 THEN grade END AS 'may',
	CASE WHEN mn=6 THEN grade END AS 'jun'
	FROM
	(
	SELECT sag4.name,sag4.gname,sag4.ou_name,IFNULL(mn,0) AS 'mn',sag4.FB,
	CASE WHEN OP_G+IP_G+MiS_G+MaS_G+De_G+RI_G+LT_G+WM+CWT+AD+DR+UC_G >= 90 THEN 'A+'
		WHEN OP_G+IP_G+MiS_G+MaS_G+De_G+RI_G+LT_G+WM+CWT+AD+DR+UC_G BETWEEN 75 AND 89 THEN 'A'
		WHEN OP_G+IP_G+MiS_G+MaS_G+De_G+RI_G+LT_G+WM+CWT+AD+DR+UC_G BETWEEN 60 AND 74 THEN 'B'
		WHEN OP_G+IP_G+MiS_G+MaS_G+De_G+RI_G+LT_G+WM+CWT+AD+DR+UC_G BETWEEN 40 AND 59 THEN 'C'
		WHEN OP_G+IP_G+MiS_G+MaS_G+De_G+RI_G+LT_G+WM+CWT+AD+DR+UC_G <40 THEN 'D'
	END AS grade 
	FROM 
	(
	SELECT sag3.name,sag3.gname,ou_name,mn,FB,OP,
	CASE WHEN FB < 20 AND ROUND(((OP/2000)*100),0) > 99 THEN 5
		WHEN FB < 20 AND ROUND(((OP/2000)*100),0) BETWEEN 80 AND 99 THEN 4
		WHEN FB < 20 AND ROUND(((OP/2000)*100),0) BETWEEN 70 AND 79 THEN 3
		WHEN FB < 20 AND ROUND(((OP/2000)*100),0) BETWEEN 60 AND 69 THEN 2
		WHEN FB < 20 AND ROUND(((OP/2000)*100),0) BETWEEN 50 AND 59 THEN 2
		WHEN FB < 20 AND ROUND(((OP/2000)*100),0) BETWEEN 40 AND 49 THEN 1
		WHEN FB < 20 AND ROUND(((OP/2000)*100),0) <40 THEN 0
		
		
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((OP/3000)*100),0)> 99 THEN 5
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((OP/3000)*100),0) BETWEEN 80 AND 99 THEN 4
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((OP/3000)*100),0) BETWEEN 70 AND 79 THEN 3
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((OP/3000)*100),0) BETWEEN 60 AND 69 THEN 2
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((OP/3000)*100),0) BETWEEN 50 AND 59 THEN 2
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((OP/3000)*100),0) BETWEEN 40 AND 49 THEN 1
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((OP/3000)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((OP/5000)*100),0)> 99 THEN 5
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((OP/5000)*100),0) BETWEEN 80 AND 99 THEN 4
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((OP/5000)*100),0) BETWEEN 70 AND 79 THEN 3
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((OP/5000)*100),0) BETWEEN 60 AND 69 THEN 2
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((OP/5000)*100),0) BETWEEN 50 AND 59 THEN 2
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((OP/5000)*100),0) BETWEEN 40 AND 49 THEN 1
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((OP/5000)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((OP/10000)*100),0)> 99 THEN 5
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((OP/10000)*100),0) BETWEEN 80 AND 99 THEN 4
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((OP/10000)*100),0) BETWEEN 70 AND 79 THEN 3
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((OP/10000)*100),0) BETWEEN 60 AND 69 THEN 2
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((OP/10000)*100),0) BETWEEN 50 AND 59 THEN 2
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((OP/10000)*100),0) BETWEEN 40 AND 49 THEN 1
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((OP/10000)*100),0) < 40 THEN 0
		 
		WHEN FB  >200 AND ROUND(((OP/20000)*100),0)> 99 THEN 5
		WHEN FB  >200 AND ROUND(((OP/20000)*100),0) BETWEEN 80 AND 99 THEN 4
		WHEN FB  >200 AND ROUND(((OP/20000)*100),0) BETWEEN 70 AND 79 THEN 3
		WHEN FB  >200 AND ROUND(((OP/20000)*100),0) BETWEEN 60 AND 69 THEN 2
		WHEN FB  >200 AND ROUND(((OP/20000)*100),0) BETWEEN 50 AND 59 THEN 2
		WHEN FB  >200 AND ROUND(((OP/20000)*100),0) BETWEEN 40 AND 49 THEN 1
		WHEN FB  >200 AND ROUND(((OP/20000)*100),0) < 40 THEN 0
		END AS 'OP_G',
		
	IP,	
	CASE WHEN FB < 20 AND ROUND(((IP/50)*100),0) > 99 THEN 15
		WHEN FB < 20 AND ROUND(((IP/50)*100),0) BETWEEN 80 AND 99 THEN 12
		WHEN FB < 20 AND ROUND(((IP/50)*100),0) BETWEEN 70 AND 79 THEN 9
		WHEN FB < 20 AND ROUND(((IP/50)*100),0) BETWEEN 60 AND 69 THEN 6
		WHEN FB < 20 AND ROUND(((IP/50)*100),0) BETWEEN 50 AND 59 THEN 5
		WHEN FB < 20 AND ROUND(((IP/50)*100),0) BETWEEN 40 AND 49 THEN 3
		WHEN FB < 20 AND ROUND(((IP/50)*100),0) <40 THEN 0
		
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((IP/100)*100),0) > 99 THEN 15
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((IP/100)*100),0) BETWEEN 80 AND 99 THEN 12
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((IP/100)*100),0) BETWEEN 70 AND 79 THEN 9
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((IP/100)*100),0) BETWEEN 60 AND 69 THEN 6
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((IP/100)*100),0) BETWEEN 50 AND 59 THEN 5
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((IP/100)*100),0) BETWEEN 40 AND 49 THEN 3
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((IP/100)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((IP/300)*100),0)> 99 THEN 15
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((IP/300)*100),0) BETWEEN 80 AND 99 THEN 12
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((IP/300)*100),0) BETWEEN 70 AND 79 THEN 9
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((IP/300)*100),0) BETWEEN 60 AND 69 THEN 6
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((IP/300)*100),0) BETWEEN 50 AND 59 THEN 5
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((IP/300)*100),0) BETWEEN 40 AND 49 THEN 3
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((IP/300)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((IP/800)*100),0)> 99 THEN 15
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((IP/800)*100),0) BETWEEN 80 AND 99 THEN 12
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((IP/800)*100),0) BETWEEN 70 AND 79 THEN 9
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((IP/800)*100),0) BETWEEN 60 AND 69 THEN 6
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((IP/800)*100),0) BETWEEN 50 AND 59 THEN 5
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((IP/800)*100),0) BETWEEN 40 AND 49 THEN 3
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((IP/800)*100),0) < 40 THEN 0
		 
		WHEN FB  >200 AND ROUND(((IP/1600)*100),0)> 99 THEN 15
		WHEN FB  >200 AND ROUND(((IP/1600)*100),0) BETWEEN 80 AND 99 THEN 12
		WHEN FB  >200 AND ROUND(((IP/1600)*100),0) BETWEEN 70 AND 79 THEN 9
		WHEN FB  >200 AND ROUND(((IP/1600)*100),0) BETWEEN 60 AND 69 THEN 6
		WHEN FB  >200 AND ROUND(((IP/1600)*100),0) BETWEEN 50 AND 59 THEN 5
		WHEN FB  >200 AND ROUND(((IP/1600)*100),0) BETWEEN 40 AND 49 THEN 3
		WHEN FB  >200 AND ROUND(((IP/1600)*100),0) < 40 THEN 0
		END AS 'IP_G',
	MiS,
	CASE WHEN FB < 20 AND ROUND(((MiS/20)*100),0) > 99 THEN 5
		WHEN FB < 20 AND ROUND(((MiS/20)*100),0) BETWEEN 80 AND 99 THEN 4
		WHEN FB < 20 AND ROUND(((MiS/20)*100),0) BETWEEN 70 AND 79 THEN 3
		WHEN FB < 20 AND ROUND(((MiS/20)*100),0) BETWEEN 60 AND 69 THEN 2
		WHEN FB < 20 AND ROUND(((MiS/20)*100),0) BETWEEN 50 AND 59 THEN 2
		WHEN FB < 20 AND ROUND(((MiS/20)*100),0) BETWEEN 40 AND 49 THEN 1
		WHEN FB < 20 AND ROUND(((MiS/20)*100),0) <40 THEN 0
		
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/50)*100),0)> 99 THEN 5
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/50)*100),0) BETWEEN 80 AND 99 THEN 4
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/50)*100),0) BETWEEN 70 AND 79 THEN 3
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/50)*100),0) BETWEEN 60 AND 69 THEN 2
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/50)*100),0) BETWEEN 50 AND 59 THEN 2
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/50)*100),0) BETWEEN 40 AND 49 THEN 1
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/50)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0)> 99 THEN 5
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0) BETWEEN 80 AND 99 THEN 4
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0) BETWEEN 70 AND 79 THEN 3
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0) BETWEEN 60 AND 69 THEN 2
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0) BETWEEN 50 AND 59 THEN 2
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0) BETWEEN 40 AND 49 THEN 1
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/400)*100),0)> 99 THEN 5
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/400)*100),0) BETWEEN 80 AND 99 THEN 4
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/400)*100),0) BETWEEN 70 AND 79 THEN 3
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/400)*100),0) BETWEEN 60 AND 69 THEN 2
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/400)*100),0) BETWEEN 50 AND 59 THEN 2
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/400)*100),0) BETWEEN 40 AND 49 THEN 1
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/400)*100),0) < 40 THEN 0
		 
		WHEN FB  >200 AND ROUND(((MiS/800)*100),0)> 99 THEN 5
		WHEN FB  >200 AND ROUND(((MiS/800)*100),0) BETWEEN 80 AND 99 THEN 4
		WHEN FB  >200 AND ROUND(((MiS/800)*100),0) BETWEEN 70 AND 79 THEN 3
		WHEN FB  >200 AND ROUND(((MiS/800)*100),0) BETWEEN 60 AND 69 THEN 2
		WHEN FB  >200 AND ROUND(((MiS/800)*100),0) BETWEEN 50 AND 59 THEN 2
		WHEN FB  >200 AND ROUND(((MiS/800)*100),0) BETWEEN 40 AND 49 THEN 1
		WHEN FB  >200 AND ROUND(((MiS/800)*100),0) < 40 THEN 0
		END AS 'MiS_G',
	MaS,	
	CASE WHEN FB < 20 AND ROUND(((MiS/10)*100),0) > 99 THEN 15
		WHEN FB < 20 AND ROUND(((MiS/10)*100),0) BETWEEN 80 AND 99 THEN 12
		WHEN FB < 20 AND ROUND(((MiS/10)*100),0) BETWEEN 70 AND 79 THEN 9
		WHEN FB < 20 AND ROUND(((MiS/10)*100),0) BETWEEN 60 AND 69 THEN 6
		WHEN FB < 20 AND ROUND(((MiS/10)*100),0) BETWEEN 50 AND 59 THEN 5
		WHEN FB < 20 AND ROUND(((MiS/10)*100),0) BETWEEN 40 AND 49 THEN 3
		WHEN FB < 20 AND ROUND(((MiS/10)*100),0) <40 THEN 0
		
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/30)*100),0)> 99 THEN 15
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/30)*100),0) BETWEEN 80 AND 99 THEN 12
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/30)*100),0) BETWEEN 70 AND 79 THEN 9
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/30)*100),0) BETWEEN 60 AND 69 THEN 6
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/30)*100),0) BETWEEN 50 AND 59 THEN 5
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/30)*100),0) BETWEEN 40 AND 49 THEN 3
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((MiS/30)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0)> 99 THEN 15
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0) BETWEEN 80 AND 99 THEN 12
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0) BETWEEN 70 AND 79 THEN 9
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0) BETWEEN 60 AND 69 THEN 6
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0) BETWEEN 50 AND 59 THEN 5
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0) BETWEEN 40 AND 49 THEN 3
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((MiS/100)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/200)*100),0)> 99 THEN 15
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/200)*100),0) BETWEEN 80 AND 99 THEN 12
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/200)*100),0) BETWEEN 70 AND 79 THEN 9
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/200)*100),0) BETWEEN 60 AND 69 THEN 6
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/200)*100),0) BETWEEN 50 AND 59 THEN 5
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/200)*100),0) BETWEEN 40 AND 49 THEN 3
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((MiS/200)*100),0) < 40 THEN 0
		 
		WHEN FB  >200 AND ROUND(((MiS/400)*100),0)> 99 THEN 15
		WHEN FB  >200 AND ROUND(((MiS/400)*100),0) BETWEEN 80 AND 99 THEN 12
		WHEN FB  >200 AND ROUND(((MiS/400)*100),0) BETWEEN 70 AND 79 THEN 9
		WHEN FB  >200 AND ROUND(((MiS/400)*100),0) BETWEEN 60 AND 69 THEN 6
		WHEN FB  >200 AND ROUND(((MiS/400)*100),0) BETWEEN 50 AND 59 THEN 5
		WHEN FB  >200 AND ROUND(((MiS/400)*100),0) BETWEEN 40 AND 49 THEN 3
		WHEN FB  >200 AND ROUND(((MiS/400)*100),0) < 40 THEN 0
		END AS 'MaS_G',
	De,
	CASE WHEN FB < 20 AND ROUND(((De/10)*100),0) > 99 THEN 10
		WHEN FB < 20 AND ROUND(((De/10)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB < 20 AND ROUND(((De/10)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB < 20 AND ROUND(((De/10)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB < 20 AND ROUND(((De/10)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB < 20 AND ROUND(((De/10)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB < 20 AND ROUND(((De/10)*100),0) <40 THEN 0
		
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((De/35)*100),0)> 99 THEN 10
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((De/35)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((De/35)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((De/35)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((De/35)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((De/35)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((De/35)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((De/50)*100),0)> 99 THEN 10
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((De/50)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((De/50)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((De/50)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((De/50)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((De/50)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((De/50)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((De/80)*100),0)> 99 THEN 10
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((De/80)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((De/80)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((De/80)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((De/80)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((De/80)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((De/80)*100),0) < 40 THEN 0
		 
		WHEN FB  >200 AND ROUND(((De/160)*100),0)> 99 THEN 10
		WHEN FB  >200 AND ROUND(((De/160)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB  >200 AND ROUND(((De/160)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB  >200 AND ROUND(((De/160)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB  >200 AND ROUND(((De/160)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB  >200 AND ROUND(((De/160)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB  >200 AND ROUND(((De/160)*100),0) < 40 THEN 0
		END AS 'De_G',
	RI,
	CASE WHEN FB < 20 AND ROUND(((RI/75)*100),0) > 99 THEN 10
		WHEN FB < 20 AND ROUND(((RI/75)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB < 20 AND ROUND(((RI/75)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB < 20 AND ROUND(((RI/75)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB < 20 AND ROUND(((RI/75)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB < 20 AND ROUND(((RI/75)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB < 20 AND ROUND(((RI/75)*100),0) <40 THEN 0
		
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((RI/150)*100),0)> 99 THEN 10
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((RI/150)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((RI/150)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((RI/150)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((RI/150)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((RI/150)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((RI/150)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((RI/650)*100),0)> 99 THEN 10
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((RI/650)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((RI/650)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((RI/650)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((RI/650)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((RI/650)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((RI/650)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((RI/1500)*100),0)> 99 THEN 10
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((RI/1500)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((RI/1500)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((RI/1500)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((RI/1500)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((RI/1500)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((RI/1500)*100),0) < 40 THEN 0
		 
		WHEN FB  >200 AND ROUND(((RI/3000)*100),0)> 99 THEN 10
		WHEN FB  >200 AND ROUND(((RI/3000)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB  >200 AND ROUND(((RI/3000)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB  >200 AND ROUND(((RI/3000)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB  >200 AND ROUND(((RI/3000)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB  >200 AND ROUND(((RI/3000)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB  >200 AND ROUND(((RI/3000)*100),0) < 40 THEN 0
		END AS 'RI_G',	
	LT,
	CASE WHEN FB < 20 AND ROUND(((LT/500)*100),0) > 99 THEN 10
		WHEN FB < 20 AND ROUND(((LT/500)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB < 20 AND ROUND(((LT/500)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB < 20 AND ROUND(((LT/500)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB < 20 AND ROUND(((LT/500)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB < 20 AND ROUND(((LT/500)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB < 20 AND ROUND(((LT/500)*100),0) <40 THEN 0
		
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((LT/1000)*100),0)> 99 THEN 10
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((LT/1000)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((LT/1000)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((LT/1000)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((LT/1000)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((LT/1000)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB BETWEEN 20 AND 49 AND ROUND(((LT/1000)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((LT/4000)*100),0)> 99 THEN 10
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((LT/4000)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((LT/4000)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((LT/4000)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((LT/4000)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((LT/4000)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB BETWEEN 50 AND 99 AND ROUND(((LT/4000)*100),0) < 40 THEN 0
		 
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((LT/8000)*100),0)> 99 THEN 10
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((LT/8000)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((LT/8000)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((LT/8000)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((LT/8000)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((LT/8000)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB BETWEEN 100 AND 200 AND ROUND(((LT/8000)*100),0) < 40 THEN 0
		 
		WHEN FB  >200 AND ROUND(((LT/16000)*100),0)> 99 THEN 10
		WHEN FB  >200 AND ROUND(((LT/16000)*100),0) BETWEEN 80 AND 99 THEN 8
		WHEN FB  >200 AND ROUND(((LT/16000)*100),0) BETWEEN 70 AND 79 THEN 6
		WHEN FB  >200 AND ROUND(((LT/16000)*100),0) BETWEEN 60 AND 69 THEN 4
		WHEN FB  >200 AND ROUND(((LT/16000)*100),0) BETWEEN 50 AND 59 THEN 3
		WHEN FB  >200 AND ROUND(((LT/16000)*100),0) BETWEEN 40 AND 49 THEN 2
		WHEN FB  >200 AND ROUND(((LT/16000)*100),0) < 40 THEN 0
		END AS 'LT_G',	
	WM,CWT,AD,DR,UCCP,UCPP,

	IFNULL(CASE WHEN UCCP > UCPP AND ROUND((((UCCP)-(UCPP))/(UCPP))*100,0) >=5 THEN 10
		WHEN UCPP=UCCP THEN 8
		WHEN UCCP>UCPP AND ROUND((((UCCP)-(UCPP))/(UCPP))*100,0) > 0 AND ROUND((((UCCP)-(UCPP))/(UCPP))*100,0) < 5 THEN 8
		WHEN UCCP<UCPP AND ROUND((((UCPP)-(UCCP))/(UCPP))*100,0) > 0 AND ROUND((((UCCP)-(UCPP))/(UCPP))*100,0)< 5 THEN 8
		
		WHEN UCCP<UCPP AND ROUND(((UCCP-UCPP)/UCPP)*100,0) BETWEEN 5 AND 10 THEN 6
		WHEN UCCP<UCPP AND ROUND(((UCCP-UCPP)/UCPP)*100,0) >10 AND ROUND(((UCCP-UCPP)/UCPP)*100,0) <=20 THEN 4
		WHEN UCCP<UCPP AND ROUND(((UCCP-UCPP)/UCPP)*100,0) >20 THEN 0 
		END ,0)AS 'UC_G'	

	FROM
	(
		SELECT sag2.name,sag2.gname,ou_name,mn,
		SUM(IFNULL(sag2.8936_1_c,0)) AS 'FB',
		SUM(IFNULL(sag2.6061_7_c,0)+IFNULL(sag2.6061_8_c,0)+IFNULL(sag2.7769_7_c,0)+IFNULL(sag2.7769_8_c,0)) AS 'OP',
		SUM(IFNULL(sag2.123_1_c,0)+IFNULL(sag2.124_1_c,0)+IFNULL(sag2.125_1_c,0)+IFNULL(sag2.126_1_c,0)) AS 'IP',
		SUM(IFNULL(sag2.7775_1_c,0)) AS 'MiS',
		SUM(IFNULL(sag2.7776_1_c,0)) AS 'MaS',
		SUM(IFNULL(sag2.1253_1_c,0)+IFNULL(sag2.1254_1_c,0)) AS 'De',
		SUM(IFNULL(sag2.6068_1_c,0)+IFNULL(sag2.6070_1_c,0)) AS 'RI',
		SUM(IFNULL(sag2.6071_1_c,0)) AS 'LT',

		' ' AS 'OI',

		SUM(IFNULL(sag2.6073_1_c,0)) AS 'WM',
		SUM(IFNULL(sag2.6074_1_c,0)) AS 'CWT',
		SUM(IFNULL(sag2.6075_1_c,0)) AS 'AD',
		SUM(IFNULL(sag2.6076_1_c,0)) AS 'DR',
		SUM(IFNULL(sag2.6072_1_c,0)) AS 'UCCP',
		SUM(IFNULL(sag2.8946_1_c,0)) AS 'UCCM',
		SUM(IFNULL(sag2.6072_1_p,0)) AS 'UCPP',
		SUM(IFNULL(sag2.8946_1_p,0)) AS 'UCPM'


		FROM
		(
		SELECT sag1.name,CASE WHEN sag1.gname LIKE 'PHSC DH' THEN 'District Hospital' WHEN sag1.gname LIKE 'PHSC SDH' THEN 'Sub District Hospital' WHEN sag1.gname LIKE 'PHSC CHC' THEN 'CHCs' END AS 'gname',
		ou_name,mn,
		CASE WHEN sag1.dataelementid=8936 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '8936_1_c',
		CASE WHEN sag1.dataelementid=6061 AND sag1.categoryoptioncomboid=7 AND sag1.time='curr_mon' THEN sag1.value END AS '6061_7_c',
		CASE WHEN sag1.dataelementid=6061 AND sag1.categoryoptioncomboid=8 AND sag1.time='curr_mon' THEN sag1.value END AS '6061_8_c',
		CASE WHEN sag1.dataelementid=7769 AND sag1.categoryoptioncomboid=7 AND sag1.time='curr_mon' THEN sag1.value END AS '7769_7_c',
		CASE WHEN sag1.dataelementid=7769 AND sag1.categoryoptioncomboid=8 AND sag1.time='curr_mon' THEN sag1.value END AS '7769_8_c',
		CASE WHEN sag1.dataelementid=123 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '123_1_c',
		CASE WHEN sag1.dataelementid=124 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '124_1_c',
		CASE WHEN sag1.dataelementid=125 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '125_1_c',
		CASE WHEN sag1.dataelementid=126 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '126_1_c',
		CASE WHEN sag1.dataelementid=7775 AND sag1.categoryoptioncomboid IN (7,8) AND sag1.time='curr_mon' THEN sag1.value END AS '7775_1_c',
		CASE WHEN sag1.dataelementid=7776 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '7776_1_c',
		CASE WHEN sag1.dataelementid=1253 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '1253_1_c',
		CASE WHEN sag1.dataelementid=1254 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '1254_1_c',
		CASE WHEN sag1.dataelementid=6068 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '6068_1_c',
		CASE WHEN sag1.dataelementid=6070 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '6070_1_c',
		CASE WHEN sag1.dataelementid=6071 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '6071_1_c',
		CASE WHEN sag1.dataelementid=6073 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '6073_1_c',
		CASE WHEN sag1.dataelementid=6074 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '6074_1_c',
		CASE WHEN sag1.dataelementid=6075 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '6075_1_c',
		CASE WHEN sag1.dataelementid=6076 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '6076_1_c',
		CASE WHEN sag1.dataelementid=6072 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '6072_1_c',
		CASE WHEN sag1.dataelementid=8946 AND sag1.categoryoptioncomboid=1 AND sag1.time='curr_mon' THEN sag1.value END AS '8946_1_c',
		CASE WHEN sag1.dataelementid=6072 AND sag1.categoryoptioncomboid=1 AND sag1.time='pre_mon' THEN sag1.value END AS '6072_1_p',
		CASE WHEN sag1.dataelementid=8946 AND sag1.categoryoptioncomboid=1 AND sag1.time='pre_mon' THEN sag1.value END AS '8946_1_p'


		FROM
		(
		
		SELECT sag.name,sag.gname,ou_name,sag.dataelementid,sag.categoryoptioncomboid,sag.time,SUM(IFNULL(sag.value,0)) AS 'value',mn
		FROM
		  
		  (
			SELECT asd.organisationunitid,asd.name,asd.gname,asd.ou_name,asd1.dataelementid,asd1.categoryoptioncomboid,asd1.value AS 'value','curr_mon' AS 'time',mn
			FROM
			(
			SELECT ou3.organisationunitid,ou.name,og.name AS 'gname',ou3.name AS 'ou_name'
			FROM orgunitgroupmembers ogm
			INNER JOIN orgunitgroup og ON ogm.orgunitgroupid = og.orgunitgroupid
			INNER JOIN _orgunitstructure os ON ogm.organisationunitid=os.organisationunitid
			INNER JOIN organisationunit ou ON ou.organisationunitid = os.idlevel3
			INNER JOIN organisationunit ou3 ON ou3.organisationunitid = os.organisationunitid
			WHERE og.name IN ('PHSC DH','PHSC SDH', 'PHSC CHC')
			)asd

			LEFT JOIN

			(
			SELECT dv.dataelementid,dv.categoryoptioncomboid,dv.value,dv.sourceid,MONTH(p.startdate) AS 'mn'
			FROM datavalue dv
			INNER JOIN period p ON p.periodid=dv.periodid 
			WHERE dv.dataelementid IN (8936,6061,6061,7769,7769,123,124,125,126,7775,7776,1254,1253,6068,6070,6071,6073,6074,6075,6076,6072,8946)
			AND dv.categoryoptioncomboid IN (1,7,8)
			AND MONTH(p.startdate) BETWEEN 1 AND 6
			AND YEAR(p.startdate) = YEAR('2014-11-01')


			)asd1

			ON asd.organisationunitid = asd1.sourceid

		UNION

			SELECT asd.organisationunitid,asd.name,asd.gname,asd.ou_name,asd1.dataelementid,asd1.categoryoptioncomboid,asd1.value AS 'value','pre_year' AS 'time',mn
			FROM
			(
			SELECT ou3.organisationunitid,ou.name,og.name AS 'gname',ou3.name AS 'ou_name'
			FROM orgunitgroupmembers ogm
			INNER JOIN orgunitgroup og ON ogm.orgunitgroupid = og.orgunitgroupid
			INNER JOIN _orgunitstructure os ON ogm.organisationunitid=os.organisationunitid
			INNER JOIN organisationunit ou ON ou.organisationunitid = os.idlevel3
			INNER JOIN organisationunit ou3 ON ou3.organisationunitid = os.organisationunitid
			WHERE og.name IN ('PHSC DH','PHSC SDH', 'PHSC CHC')

			)asd

			LEFT JOIN

			(
			SELECT dv.dataelementid,dv.categoryoptioncomboid,dv.value,dv.sourceid,MONTH(p.startdate) AS 'mn'
			FROM datavalue dv
			INNER JOIN period p ON p.periodid=dv.periodid 
			WHERE dv.dataelementid IN (6072,8946)
			AND dv.categoryoptioncomboid IN (1)
			AND MONTH(p.startdate) BETWEEN 1 AND 6
			AND YEAR(p.startdate) = YEAR('2014-11-01')-1


			)asd1

			ON asd.organisationunitid = asd1.sourceid

		)sag
		GROUP BY sag.name,sag.gname,ou_name,sag.dataelementid,sag.categoryoptioncomboid,sag.time,mn

		)sag1
		)sag2

		GROUP BY sag2.name,sag2.gname,ou_name,mn
	)sag3	
	)sag4
	)sag5
)sag6
GROUP BY sag6.name,gname,ou_name	
ORDER BY sag6.name,seq,ou_name	