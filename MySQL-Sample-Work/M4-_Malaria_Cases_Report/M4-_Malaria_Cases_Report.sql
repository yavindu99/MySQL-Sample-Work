SELECT sag1.name,
SUM(IFNULL(sag1.8011_1,0))  AS '8011_1',
SUM(IFNULL(sag1.8013_1,0))  AS '8013_1',
SUM(IFNULL(sag1.8015_1,0))  AS '8015_1',
SUM(IFNULL(sag1.8017_1,0))  AS '8017_1',
SUM(IFNULL(sag1.8019_1,0))  AS '8019_1',
SUM(IFNULL(sag1.8021_1,0))  AS '8021_1',
SUM(IFNULL(sag1.8023_1,0))  AS '8023_1',
SUM(IFNULL(sag1.8025_1,0))  AS '8025_1',
SUM(IFNULL(sag1.8027_1,0))  AS '8027_1',
SUM(IFNULL(sag1.8012_1,0))  AS '8012_1',
SUM(IFNULL(sag1.8014_1,0))  AS '8014_1',
SUM(IFNULL(sag1.8016_1,0))  AS '8016_1',
SUM(IFNULL(sag1.8018_1,0))  AS '8018_1',
SUM(IFNULL(sag1.8020_1,0))  AS '8020_1',
SUM(IFNULL(sag1.8022_1,0))  AS '8022_1',
SUM(IFNULL(sag1.8024_1,0))  AS '8024_1',
SUM(IFNULL(sag1.8026_1,0))  AS '8026_1',
SUM(IFNULL(sag1.8028_1,0))  AS '8028_1',

SUM(IFNULL(sag1.7657_1,0))  AS '7657_1',
SUM(IFNULL(sag1.7668_1,0))  AS '7668_1',
SUM(IFNULL(sag1.7669_1,0))  AS '7669_1',
SUM(IFNULL(sag1.7375_1,0))  AS '7375_1',
SUM(IFNULL(sag1.7377_1,0))  AS '7377_1',
SUM(IFNULL(sag1.7372_1,0))  AS '7372_1',
SUM(IFNULL(sag1.7373_1,0))  AS '7373_1',
SUM(IFNULL(sag1.7374_1,0))  AS '7374_1',
SUM(IFNULL(sag1.7665_1,0))  AS '7665_1',
SUM(IFNULL(sag1.7670_1,0))  AS '7670_1',
SUM(IFNULL(sag1.7671_1,0))  AS '7671_1',

SUM(IFNULL(sag1.8031_1,0))  AS '8031_1',
SUM(IFNULL(sag1.8033_1,0))  AS '8033_1',
SUM(IFNULL(sag1.8035_1,0))  AS '8035_1',
SUM(IFNULL(sag1.8037_1,0))  AS '8037_1',
SUM(IFNULL(sag1.8039_1,0))  AS '8039_1',
SUM(IFNULL(sag1.8041_1,0))  AS '8041_1',
SUM(IFNULL(sag1.8043_1,0))  AS '8043_1',
SUM(IFNULL(sag1.8045_1,0))  AS '8045_1',
SUM(IFNULL(sag1.8047_1,0))  AS '8047_1',
SUM(IFNULL(sag1.8097_1,0))  AS '8097_1',
SUM(IFNULL(sag1.8049_1,0))  AS '8049_1',
SUM(IFNULL(sag1.8051_1,0))  AS '8051_1',
SUM(IFNULL(sag1.8053_1,0))  AS '8053_1',
SUM(IFNULL(sag1.8055_1,0))  AS '8055_1',
SUM(IFNULL(sag1.8057_1,0))  AS '8057_1',
SUM(IFNULL(sag1.8058_1,0))  AS '8058_1',
SUM(IFNULL(sag1.8032_1,0))  AS '8032_1',
SUM(IFNULL(sag1.8034_1,0))  AS '8034_1',
SUM(IFNULL(sag1.8036_1,0))  AS '8036_1',
SUM(IFNULL(sag1.8038_1,0))  AS '8038_1',
SUM(IFNULL(sag1.8040_1,0))  AS '8040_1',
SUM(IFNULL(sag1.8042_1,0))  AS '8042_1',
SUM(IFNULL(sag1.8044_1,0))  AS '8044_1',
SUM(IFNULL(sag1.8046_1,0))  AS '8046_1',
SUM(IFNULL(sag1.8048_1,0))  AS '8048_1',
SUM(IFNULL(sag1.8098_1,0))  AS '8098_1',
SUM(IFNULL(sag1.8050_1,0))  AS '8050_1',
SUM(IFNULL(sag1.8052_1,0))  AS '8052_1',
SUM(IFNULL(sag1.8054_1,0))  AS '8054_1',
SUM(IFNULL(sag1.8056_2,0))  AS '8056_2',
SUM(IFNULL(sag1.8059_1,0))  AS '8059_1',
SUM(IFNULL(sag1.8060_1,0))  AS '8060_1',

SUM(IFNULL(sag1.7502_7,0))  AS '7502_7',
SUM(IFNULL(sag1.7503_7,0))  AS '7503_7',
SUM(IFNULL(sag1.7504_7,0))  AS '7504_7',
SUM(IFNULL(sag1.7505_7,0))  AS '7505_7',
SUM(IFNULL(sag1.7506_7,0))  AS '7506_7',
SUM(IFNULL(sag1.7502_8,0))  AS '7502_8',
SUM(IFNULL(sag1.7503_8,0))  AS '7503_8',
SUM(IFNULL(sag1.7504_8,0))  AS '7504_8',
SUM(IFNULL(sag1.7505_8,0))  AS '7505_8',
SUM(IFNULL(sag1.7506_8,0))  AS '7506_8',
SUM(IFNULL(sag1.7507_1,0))  AS '7507_1',
SUM(IFNULL(sag1.7508_1,0))  AS '7508_1',
SUM(IFNULL(sag1.7419_1,0))  AS '7419_1',
SUM(IFNULL(sag1.7420_1,0))  AS '7420_1',
SUM(IFNULL(sag1.7421_1,0))  AS '7421_1',
SUM(IFNULL(sag1.7402_1,0))  AS '7402_1',
SUM(IFNULL(sag1.7519_1,0))  AS '7519_1',
SUM(IFNULL(sag1.7520_1,0))  AS '7520_1',
SUM(IFNULL(sag1.7521_1,0))  AS '7521_1',
SUM(IFNULL(sag1.7522_1,0))  AS '7522_1',
SUM(IFNULL(sag1.7523_1,0))  AS '7523_1',
SUM(IFNULL(sag1.8114_1,0))  AS '8114_1'

FROM
(
SELECT sag.name,
CASE WHEN sag.dataelementid=8011 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8011_1',
CASE WHEN sag.dataelementid=8013 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8013_1', 
CASE WHEN sag.dataelementid=8015 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8015_1', 
CASE WHEN sag.dataelementid=8017 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8017_1', 
CASE WHEN sag.dataelementid=8019 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8019_1', 
CASE WHEN sag.dataelementid=8021 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8021_1', 
CASE WHEN sag.dataelementid=8023 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8023_1', 
CASE WHEN sag.dataelementid=8025 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8025_1', 
CASE WHEN sag.dataelementid=8027 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8027_1', 
CASE WHEN sag.dataelementid=8012 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8012_1', 
CASE WHEN sag.dataelementid=8014 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8014_1',
CASE WHEN sag.dataelementid=8016 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8016_1', 
CASE WHEN sag.dataelementid=8018 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8018_1', 
CASE WHEN sag.dataelementid=8020 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8020_1', 
CASE WHEN sag.dataelementid=8022 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8022_1', 
CASE WHEN sag.dataelementid=8024 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8024_1', 
CASE WHEN sag.dataelementid=8026 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8026_1',
CASE WHEN sag.dataelementid=8028 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8028_1', 

CASE WHEN sag.dataelementid=7657 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7657_1', 
CASE WHEN sag.dataelementid=7668 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7668_1', 
CASE WHEN sag.dataelementid=7669 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7669_1', 
CASE WHEN sag.dataelementid=7375 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7375_1', 
CASE WHEN sag.dataelementid=7377 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7377_1', 
CASE WHEN sag.dataelementid=7372 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7372_1', 
CASE WHEN sag.dataelementid=7373 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7373_1', 
CASE WHEN sag.dataelementid=7374 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7374_1', 
CASE WHEN sag.dataelementid=7665 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7665_1', 
CASE WHEN sag.dataelementid=7670 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7670_1', 
CASE WHEN sag.dataelementid=7671 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7671_1',

CASE WHEN sag.dataelementid=8031 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8031_1', 
CASE WHEN sag.dataelementid=8033 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8033_1', 
CASE WHEN sag.dataelementid=8035 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8035_1', 
CASE WHEN sag.dataelementid=8037 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8037_1', 
CASE WHEN sag.dataelementid=8039 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8039_1',
CASE WHEN sag.dataelementid=8041 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8041_1', 
CASE WHEN sag.dataelementid=8043 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8043_1', 
CASE WHEN sag.dataelementid=8045 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8045_1', 
CASE WHEN sag.dataelementid=8047 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8047_1', 
CASE WHEN sag.dataelementid=8097 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8097_1', 
CASE WHEN sag.dataelementid=8049 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8049_1', 
CASE WHEN sag.dataelementid=8051 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8051_1', 
CASE WHEN sag.dataelementid=8053 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8053_1', 
CASE WHEN sag.dataelementid=8055 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8055_1', 
CASE WHEN sag.dataelementid=8057 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8057_1', 
CASE WHEN sag.dataelementid=8058 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8058_1', 
CASE WHEN sag.dataelementid=8032 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8032_1', 
CASE WHEN sag.dataelementid=8034 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8034_1', 
CASE WHEN sag.dataelementid=8036 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8036_1', 
CASE WHEN sag.dataelementid=8038 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8038_1', 
CASE WHEN sag.dataelementid=8040 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8040_1',
CASE WHEN sag.dataelementid=8042 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8042_1', 
CASE WHEN sag.dataelementid=8044 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8044_1', 
CASE WHEN sag.dataelementid=8046 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8046_1', 
CASE WHEN sag.dataelementid=8048 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8048_1', 
CASE WHEN sag.dataelementid=8098 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8098_1', 
CASE WHEN sag.dataelementid=8050 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8050_1', 
CASE WHEN sag.dataelementid=8052 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8052_1', 
CASE WHEN sag.dataelementid=8054 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8054_1', 
CASE WHEN sag.dataelementid=8056 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8056_2', 
CASE WHEN sag.dataelementid=8058 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8060_1', 
CASE WHEN sag.dataelementid=8059 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8059_1', 

CASE WHEN sag.dataelementid=7502 AND sag.categoryoptioncomboid=7 THEN sag.value END AS '7502_7', 
CASE WHEN sag.dataelementid=7503 AND sag.categoryoptioncomboid=7 THEN sag.value END AS '7503_7', 
CASE WHEN sag.dataelementid=7504 AND sag.categoryoptioncomboid=7 THEN sag.value END AS '7504_7', 
CASE WHEN sag.dataelementid=7505 AND sag.categoryoptioncomboid=7 THEN sag.value END AS '7505_7', 
CASE WHEN sag.dataelementid=7506 AND sag.categoryoptioncomboid=7 THEN sag.value END AS '7506_7', 
CASE WHEN sag.dataelementid=7502 AND sag.categoryoptioncomboid=8 THEN sag.value END AS '7502_8', 
CASE WHEN sag.dataelementid=7503 AND sag.categoryoptioncomboid=8 THEN sag.value END AS '7503_8', 
CASE WHEN sag.dataelementid=7504 AND sag.categoryoptioncomboid=8 THEN sag.value END AS '7504_8', 
CASE WHEN sag.dataelementid=7505 AND sag.categoryoptioncomboid=8 THEN sag.value END AS '7505_8', 
CASE WHEN sag.dataelementid=7506 AND sag.categoryoptioncomboid=8 THEN sag.value END AS '7506_8', 
CASE WHEN sag.dataelementid=7507 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7507_1', 
CASE WHEN sag.dataelementid=7508 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7508_1', 
CASE WHEN sag.dataelementid=7419 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7419_1', 
CASE WHEN sag.dataelementid=7420 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7420_1', 
CASE WHEN sag.dataelementid=7421 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7421_1', 
CASE WHEN sag.dataelementid=7402 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7402_1', 
CASE WHEN sag.dataelementid=7519 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7519_1', 
CASE WHEN sag.dataelementid=7520 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7520_1', 
CASE WHEN sag.dataelementid=7521 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7521_1', 
CASE WHEN sag.dataelementid=7522 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7522_1', 
CASE WHEN sag.dataelementid=7523 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '7523_1', 

CASE WHEN sag.dataelementid=8114 AND sag.categoryoptioncomboid=1 THEN sag.value END AS '8114_1'






FROM
(
SELECT asd.organisationunitid,asd.name,asd.fname,asd1.dataelementid,asd1.categoryoptioncomboid,asd1.value 
FROM
(
SELECT ou3.organisationunitid,ou.name,og.name AS 'gname',ou3.name AS 'fname'
FROM orgunitgroupmembers ogm
INNER JOIN orgunitgroup og ON ogm.orgunitgroupid = og.orgunitgroupid
INNER JOIN _orgunitstructure os ON ogm.organisationunitid=os.organisationunitid
INNER JOIN organisationunit ou ON ou.organisationunitid = os.idlevel3
INNER JOIN organisationunit ou3 ON ou3.organisationunitid = os.organisationunitid
WHERE og.name IN ('PHCs','RH','Sub Centres')
#AND ou.name LIKE 'Ludhiana District'

)asd

LEFT JOIN

(
SELECT dv.dataelementid,dv.categoryoptioncomboid,dv.value,dv.sourceid,p.startdate
FROM datavalue dv
INNER JOIN period p ON p.periodid=dv.periodid 
WHERE dv.dataelementid IN (8011,8013,8015,8017,8019,8021,8023,8025,8027,8012,8014,8016,8018,8020,8022,8024,8026.8028,
			7657,7668,7669,7375,7377,7372,7373,7374,7665,7670,7671,8031,8033,8035,8037,8039,8041,8043,8045,
			8047,8097,8049,8051,8053,8055,8057,8058,8032,8034,8036,8038,8040,8042,8044,8046,8048,8098,8050,
			8052,8054,8056,8059,8060,7502,7503,7504,7505,7506,7507,7508,7419,7420,
			7421,7402,7519,7520,7521,7522,7523,8114)
AND dv.categoryoptioncomboid IN (1,8,7)
AND MONTH(p.startdate)= MONTH('2013-09-01') 
AND YEAR(p.startdate) = YEAR('2013-09-01')
AND periodtypeid = 3

)asd1

ON asd.organisationunitid = asd1.sourceid
)sag
)sag1

GROUP BY sag1.name