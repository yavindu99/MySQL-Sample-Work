# half done

SELECT sag1.idlevel3,sag1.name,
SUM(IFNULL(sag1.3,0)) AS '3',
SUM(IFNULL(sag1.4,0)) AS '4',
SUM(IFNULL(sag1.5,0)) AS '5',
SUM(IFNULL(sag1.6,0)) AS '6',
SUM(IFNULL(sag1.7,0)) AS '7',
SUM(IFNULL(sag1.8,0)) AS '8',
SUM(IFNULL(sag1.9,0)) AS '9',
SUM(IFNULL(sag1.10,0)) AS '10',
SUM(IFNULL(sag1.11,0)) AS '11',
SUM(IFNULL(sag1.12,0)) AS '12',
SUM(IFNULL(sag1.13,0)) AS '13',
SUM(IFNULL(sag1.19,0)) AS '19',
SUM(IFNULL(sag1.20,0)) AS '20',
SUM(IFNULL(sag1.21,0)) AS '21',
SUM(IFNULL(sag1.23,0)) AS '23',
SUM(IFNULL(sag1.24,0)) AS '24',
SUM(IFNULL(sag1.25,0)) AS '25',
SUM(IFNULL(sag1.33,0)) AS '33',
SUM(IFNULL(sag1.36,0)) AS '36',
SUM(IFNULL(sag1.37,0)) AS '37',
SUM(IFNULL(sag1.38,0)) AS '38',
SUM(IFNULL(sag1.39,0)) AS '39',
SUM(IFNULL(sag1.40,0)) AS '40',
SUM(IFNULL(sag1.41,0)) AS '41',
SUM(IFNULL(sag1.42,0)) AS '42',
SUM(IFNULL(sag1.5775,0)) AS '5775',

SUM(IFNULL(sag1.1253,0)) AS '1253',
SUM(IFNULL(sag1.1254,0)) AS '1254',
SUM(IFNULL(sag1.1256,0)) AS '1256',
SUM(IFNULL(sag1.1257,0)) AS '1257',
SUM(IFNULL(sag1.1260,0)) AS '1260',
SUM(IFNULL(sag1.1261,0)) AS '1261',

SUM(IFNULL(sag1.5791,0)) AS '5791',
SUM(IFNULL(sag1.5792,0)) AS '5792',

SUM(IFNULL(sag1.5793,0)) AS '5793',
SUM(IFNULL(sag1.5794,0)) AS '5794',
SUM(IFNULL(sag1.5795,0)) AS '5795',
SUM(IFNULL(sag1.5796,0)) AS '5796',
SUM(IFNULL(sag1.5797,0)) AS '5797',
SUM(IFNULL(sag1.5798,0)) AS '5798',
SUM(IFNULL(sag1.5799,0)) AS '5799',
SUM(IFNULL(sag1.5800,0)) AS '5800',
SUM(IFNULL(sag1.5801,0)) AS '5801',
SUM(IFNULL(sag1.5802,0)) AS '5802',
SUM(IFNULL(sag1.5803,0)) AS '5803',

SUM(IFNULL(sag1.515,0)) AS '515',
SUM(IFNULL(sag1.516,0)) AS '516',
SUM(IFNULL(sag1.521,0)) AS '521',
SUM(IFNULL(sag1.522,0)) AS '522',
SUM(IFNULL(sag1.5813,0)) AS '5813',
SUM(IFNULL(sag1.5814,0)) AS '5814',
SUM(IFNULL(sag1.5815,0)) AS '5815',
SUM(IFNULL(sag1.5816,0)) AS '5816',
SUM(IFNULL(sag1.5817,0)) AS '5817',
SUM(IFNULL(sag1.5818,0)) AS '5818',
SUM(IFNULL(sag1.5819,0)) AS '5819',
SUM(IFNULL(sag1.5820,0)) AS '5820',
SUM(IFNULL(sag1.5821,0)) AS '5821',
SUM(IFNULL(sag1.5822,0)) AS '5822',
SUM(IFNULL(sag1.5823,0)) AS '5823',
SUM(IFNULL(sag1.5824,0)) AS '5824',
SUM(IFNULL(sag1.5825,0)) AS '5825',
SUM(IFNULL(sag1.5826,0)) AS '5826',
SUM(IFNULL(sag1.5827,0)) AS '5827',
SUM(IFNULL(sag1.5828,0)) AS '5828',
SUM(IFNULL(sag1.5829,0)) AS '5829',
SUM(IFNULL(sag1.5830,0)) AS '5830',
SUM(IFNULL(sag1.5831,0)) AS '5831',
SUM(IFNULL(sag1.5832,0)) AS '5832',
SUM(IFNULL(sag1.5833,0)) AS '5833',
SUM(IFNULL(sag1.5834,0)) AS '5834',
SUM(IFNULL(sag1.5835,0)) AS '5835',
SUM(IFNULL(sag1.5836,0)) AS '5836',
SUM(IFNULL(sag1.5837,0)) AS '5837',
SUM(IFNULL(sag1.5838,0)) AS '5838',
SUM(IFNULL(sag1.5839,0)) AS '5839',
SUM(IFNULL(sag1.5840,0)) AS '5840',
SUM(IFNULL(sag1.5841,0)) AS '5841',
SUM(IFNULL(sag1.5842,0)) AS '5842',
SUM(IFNULL(sag1.5843,0)) AS '5843',
SUM(IFNULL(sag1.5844,0)) AS '5844',
SUM(IFNULL(sag1.5845,0)) AS '5845',
SUM(IFNULL(sag1.5846,0)) AS '5846',
SUM(IFNULL(sag1.5847,0)) AS '5847',
SUM(IFNULL(sag1.5848,0)) AS '5848',
SUM(IFNULL(sag1.5849,0)) AS '5849',
SUM(IFNULL(sag1.5850,0)) AS '5850',
SUM(IFNULL(sag1.5851,0)) AS '5851',
SUM(IFNULL(sag1.5852,0)) AS '5852',
SUM(IFNULL(sag1.5853,0)) AS '5853',
SUM(IFNULL(sag1.5854,0)) AS '5854',
SUM(IFNULL(sag1.5855,0)) AS '5855',
SUM(IFNULL(sag1.5856,0)) AS '5856',
SUM(IFNULL(sag1.5857,0)) AS '5857',
SUM(IFNULL(sag1.5858,0)) AS '5858',
SUM(IFNULL(sag1.5859,0)) AS '5859',
SUM(IFNULL(sag1.5860,0)) AS '5860',
SUM(IFNULL(sag1.5861,0)) AS '5861',
SUM(IFNULL(sag1.5862,0)) AS '5862',
SUM(IFNULL(sag1.5863,0)) AS '5863',
SUM(IFNULL(sag1.5864,0)) AS '5864',
SUM(IFNULL(sag1.5865,0)) AS '5865',
SUM(IFNULL(sag1.5866,0)) AS '5866',
SUM(IFNULL(sag1.5867,0)) AS '5867',
SUM(IFNULL(sag1.5868,0)) AS '5868',
SUM(IFNULL(sag1.5869,0)) AS '5869',
SUM(IFNULL(sag1.5870,0)) AS '5870',
SUM(IFNULL(sag1.5871,0)) AS '5871',
SUM(IFNULL(sag1.5872,0)) AS '5872',
SUM(IFNULL(sag1.5873,0)) AS '5873',
SUM(IFNULL(sag1.5874,0)) AS '5874',
SUM(IFNULL(sag1.5875,0)) AS '5875',
SUM(IFNULL(sag1.5876,0)) AS '5876',
SUM(IFNULL(sag1.5877,0)) AS '5877'

FROM
(
SELECT sag.idlevel3,sag.name,
CASE WHEN sag.heading =3 THEN sag.value END AS '3',
CASE WHEN sag.heading =4 THEN sag.value END AS '4',
CASE WHEN sag.heading =5 THEN sag.value END AS '5',
CASE WHEN sag.heading =6 THEN sag.value END AS '6',
CASE WHEN sag.heading =7 THEN sag.value END AS '7',
CASE WHEN sag.heading =8 THEN sag.value END AS '8',
CASE WHEN sag.heading =9 THEN sag.value END AS '9',
CASE WHEN sag.heading =10 THEN sag.value END AS '10',
CASE WHEN sag.heading =11 THEN sag.value END AS '11',
CASE WHEN sag.heading =12 THEN sag.value END AS '12',
CASE WHEN sag.heading =13 THEN sag.value END AS '13',
CASE WHEN sag.heading =19 THEN sag.value END AS '19',
CASE WHEN sag.heading =20 THEN sag.value END AS '20',
CASE WHEN sag.heading =21 THEN sag.value END AS '21',
CASE WHEN sag.heading = 23  THEN sag.value END AS '23',
CASE WHEN sag.heading = 24  THEN sag.value END AS '24',
CASE WHEN sag.heading =25 THEN sag.value END AS '25',
CASE WHEN sag.heading =33 THEN sag.value END AS '33',
CASE WHEN sag.heading =36 THEN sag.value END AS '36',
CASE WHEN sag.heading =37 THEN sag.value END AS '37',
CASE WHEN sag.heading =38 THEN sag.value END AS '38',
CASE WHEN sag.heading =39 THEN sag.value END AS '39',

CASE WHEN sag.heading =40 THEN sag.value END AS '40',
CASE WHEN sag.heading =41 THEN sag.value END AS '41',
CASE WHEN sag.heading =42 THEN sag.value END AS '42',
CASE WHEN sag.heading =5775 THEN sag.value END AS '5775',

CASE WHEN sag.heading =1253 THEN sag.value END AS '1253',
CASE WHEN sag.heading =1254 THEN sag.value END AS '1254',
CASE WHEN sag.heading =1256 THEN sag.value END AS '1256',
CASE WHEN sag.heading =1257 THEN sag.value END AS '1257',
CASE WHEN sag.heading =1260 THEN sag.value END AS '1260',
CASE WHEN sag.heading =1261 THEN sag.value END AS '1261',

CASE WHEN sag.heading =5791 THEN sag.value END AS '5791',
CASE WHEN sag.heading =5792 THEN sag.value END AS '5792',

CASE WHEN sag.heading =5793 THEN sag.value END AS '5793',
CASE WHEN sag.heading =5794 THEN sag.value END AS '5794',
CASE WHEN sag.heading =5795 THEN sag.value END AS '5795',
CASE WHEN sag.heading =5796 THEN sag.value END AS '5796',
CASE WHEN sag.heading =5797 THEN sag.value END AS '5797',
CASE WHEN sag.heading =5798 THEN sag.value END AS '5798',
CASE WHEN sag.heading =5799 THEN sag.value END AS '5799',
CASE WHEN sag.heading =5800 THEN sag.value END AS '5800',
CASE WHEN sag.heading =5801 THEN sag.value END AS '5801',
CASE WHEN sag.heading =5802 THEN sag.value END AS '5802',
CASE WHEN sag.heading =5803 THEN sag.value END AS '5803',

CASE WHEN sag.heading =515 THEN sag.value END AS '515',
CASE WHEN sag.heading =516 THEN sag.value END AS '516',
CASE WHEN sag.heading =521 THEN sag.value END AS '521',
CASE WHEN sag.heading =522 THEN sag.value END AS '522',
CASE WHEN sag.heading =	5813	THEN sag.value END AS '5813',
CASE WHEN sag.heading =	5814	THEN sag.value END AS '5814',
CASE WHEN sag.heading =	5815	THEN sag.value END AS '5815',
CASE WHEN sag.heading =	5816	THEN sag.value END AS '5816',
CASE WHEN sag.heading =	5817	THEN sag.value END AS '5817',
CASE WHEN sag.heading =	5818	THEN sag.value END AS '5818',
CASE WHEN sag.heading =	5819	THEN sag.value END AS '5819',
CASE WHEN sag.heading =	5820	THEN sag.value END AS '5820',
CASE WHEN sag.heading =	5821	THEN sag.value END AS '5821',
CASE WHEN sag.heading =	5822	THEN sag.value END AS '5822',
CASE WHEN sag.heading =	5823	THEN sag.value END AS '5823',
CASE WHEN sag.heading =	5824	THEN sag.value END AS '5824',
CASE WHEN sag.heading =	5825	THEN sag.value END AS '5825',
CASE WHEN sag.heading =	5826	THEN sag.value END AS '5826',
CASE WHEN sag.heading =	5827	THEN sag.value END AS '5827',
CASE WHEN sag.heading =	5828	THEN sag.value END AS '5828',
CASE WHEN sag.heading =	5829	THEN sag.value END AS '5829',
CASE WHEN sag.heading =	5830	THEN sag.value END AS '5830',
CASE WHEN sag.heading =	5831	THEN sag.value END AS '5831',
CASE WHEN sag.heading =	5832	THEN sag.value END AS '5832',
CASE WHEN sag.heading =	5833	THEN sag.value END AS '5833',
CASE WHEN sag.heading =	5834	THEN sag.value END AS '5834',
CASE WHEN sag.heading =	5835	THEN sag.value END AS '5835',
CASE WHEN sag.heading =	5836	THEN sag.value END AS '5836',
CASE WHEN sag.heading =	5837	THEN sag.value END AS '5837',
CASE WHEN sag.heading =	5838	THEN sag.value END AS '5838',
CASE WHEN sag.heading =	5839	THEN sag.value END AS '5839',
CASE WHEN sag.heading =	5840	THEN sag.value END AS '5840',
CASE WHEN sag.heading =	5841	THEN sag.value END AS '5841',
CASE WHEN sag.heading =	5842	THEN sag.value END AS '5842',
CASE WHEN sag.heading =	5843	THEN sag.value END AS '5843',
CASE WHEN sag.heading =	5844	THEN sag.value END AS '5844',
CASE WHEN sag.heading =	5845	THEN sag.value END AS '5845',
CASE WHEN sag.heading =	5846	THEN sag.value END AS '5846',
CASE WHEN sag.heading =	5847	THEN sag.value END AS '5847',
CASE WHEN sag.heading =	5848	THEN sag.value END AS '5848',
CASE WHEN sag.heading =	5849	THEN sag.value END AS '5849',
CASE WHEN sag.heading =	5850	THEN sag.value END AS '5850',
CASE WHEN sag.heading =	5851	THEN sag.value END AS '5851',
CASE WHEN sag.heading =	5852	THEN sag.value END AS '5852',
CASE WHEN sag.heading =	5853	THEN sag.value END AS '5853',
CASE WHEN sag.heading =	5854	THEN sag.value END AS '5854',
CASE WHEN sag.heading =	5855	THEN sag.value END AS '5855',
CASE WHEN sag.heading =	5856	THEN sag.value END AS '5856',
CASE WHEN sag.heading =	5857	THEN sag.value END AS '5857',
CASE WHEN sag.heading =	5858	THEN sag.value END AS '5858',
CASE WHEN sag.heading =	5859	THEN sag.value END AS '5859',
CASE WHEN sag.heading =	5860	THEN sag.value END AS '5860',
CASE WHEN sag.heading =	5861	THEN sag.value END AS '5861',
CASE WHEN sag.heading =	5862	THEN sag.value END AS '5862',
CASE WHEN sag.heading =	5863	THEN sag.value END AS '5863',
CASE WHEN sag.heading =	5864	THEN sag.value END AS '5864',
CASE WHEN sag.heading =	5865	THEN sag.value END AS '5865',
CASE WHEN sag.heading =	5866	THEN sag.value END AS '5866',
CASE WHEN sag.heading =	5867	THEN sag.value END AS '5867',
CASE WHEN sag.heading =	5868	THEN sag.value END AS '5868',
CASE WHEN sag.heading =	5869	THEN sag.value END AS '5869',
CASE WHEN sag.heading =	5870	THEN sag.value END AS '5870',
CASE WHEN sag.heading =	5871	THEN sag.value END AS '5871',
CASE WHEN sag.heading =	5872	THEN sag.value END AS '5872',
CASE WHEN sag.heading =	5873	THEN sag.value END AS '5873',
CASE WHEN sag.heading =	5874	THEN sag.value END AS '5874',
CASE WHEN sag.heading =	5875	THEN sag.value END AS '5875',
CASE WHEN sag.heading =	5876	THEN sag.value END AS '5876',
CASE WHEN sag.heading =	5877	THEN sag.value END AS '5877'


FROM
(
SELECT asd.idlevel3, asd.name,asd1.heading, SUM(asd1.value) AS 'value'
FROM
(
SELECT os.organisationunitid,os.idlevel3,og.name AS 'gname',ou.name
FROM orgunitgroupmembers ogm
INNER JOIN orgunitgroup og ON ogm.orgunitgroupid = og.orgunitgroupid
INNER JOIN _orgunitstructure os ON ogm.organisationunitid=os.organisationunitid
INNER JOIN organisationunit ou ON ou.organisationunitid = os.organisationunitid
WHERE og.name IN ('District Hospitals','Sub District Hospitals','Medical College','CHCs','PHCs','RH')
AND ou.name LIKE 'Channawal CHC'
)asd

LEFT JOIN

(
SELECT dv.dataelementid,dv.categoryoptioncomboid,dv.value,dv.sourceid, 
CASE WHEN dv.dataelementid =3 THEN 3
 WHEN dv.dataelementid =4 THEN 4
 WHEN dv.dataelementid =5 THEN 5
 WHEN dv.dataelementid =6 THEN 6
 WHEN dv.dataelementid =7 THEN 7
 WHEN dv.dataelementid =8 THEN 8
 WHEN dv.dataelementid =9 THEN 9
 WHEN dv.dataelementid =10 THEN 10
 WHEN dv.dataelementid =11 THEN 11
 WHEN dv.dataelementid =12 THEN 12
 WHEN dv.dataelementid =13 THEN 13
 
 WHEN dv.dataelementid =19 THEN 19
 WHEN dv.dataelementid =20 THEN 20
 WHEN dv.dataelementid =21 THEN 21
 WHEN dv.dataelementid =23 THEN 23
 WHEN dv.dataelementid =24 THEN 24
 WHEN dv.dataelementid =25 THEN 25
 
 WHEN dv.dataelementid =33 THEN 33
 WHEN dv.dataelementid =36 THEN 36
 WHEN dv.dataelementid =37 THEN 37
 WHEN dv.dataelementid =38 THEN 38
 WHEN dv.dataelementid =39 THEN 39
 WHEN dv.dataelementid =40 THEN 40
 WHEN dv.dataelementid =41 THEN 41
 WHEN dv.dataelementid =42 THEN 42
 
 WHEN dv.dataelementid =5775 THEN 5775
 
 WHEN dv.dataelementid =1253 THEN 1253
 WHEN dv.dataelementid =1254 THEN 1254
 WHEN dv.dataelementid =1256 THEN 1256
 WHEN dv.dataelementid =1257 THEN 1257
 WHEN dv.dataelementid =1260 THEN 1260
 WHEN dv.dataelementid =1261 THEN 1261
 
 WHEN dv.dataelementid =5791 THEN 5791
 WHEN dv.dataelementid =5792 THEN 5792
 WHEN dv.dataelementid =5793 THEN 5793
 WHEN dv.dataelementid =5794 THEN 5794
 WHEN dv.dataelementid =5795 THEN 5795
 WHEN dv.dataelementid =5796 THEN 5796
 WHEN dv.dataelementid =5797 THEN 5797
 WHEN dv.dataelementid =5798 THEN 5798
 WHEN dv.dataelementid =5799 THEN 5799
 
 WHEN dv.dataelementid =5800 THEN 5800
 WHEN dv.dataelementid =5801 THEN 5801
 WHEN dv.dataelementid =5802 THEN 5802
 WHEN dv.dataelementid =5803 THEN 5803
 
  WHEN dv.dataelementid =515 THEN 515
  WHEN dv.dataelementid =516 THEN 516
  WHEN dv.dataelementid =521 THEN 521
  WHEN dv.dataelementid =522 THEN 522
  WHEN dv.dataelementid =	5813	THEN	5813
WHEN dv.dataelementid =	5814	THEN	5814
WHEN dv.dataelementid =	5815	THEN	5815
WHEN dv.dataelementid =	5816	THEN	5816
WHEN dv.dataelementid =	5817	THEN	5817
WHEN dv.dataelementid =	5818	THEN	5818
WHEN dv.dataelementid =	5819	THEN	5819
WHEN dv.dataelementid =	5820	THEN	5820
WHEN dv.dataelementid =	5821	THEN	5821
WHEN dv.dataelementid =	5822	THEN	5822
WHEN dv.dataelementid =	5823	THEN	5823
WHEN dv.dataelementid =	5824	THEN	5824
WHEN dv.dataelementid =	5825	THEN	5825
WHEN dv.dataelementid =	5826	THEN	5826
WHEN dv.dataelementid =	5827	THEN	5827
WHEN dv.dataelementid =	5828	THEN	5828
WHEN dv.dataelementid =	5829	THEN	5829
WHEN dv.dataelementid =	5830	THEN	5830
WHEN dv.dataelementid =	5831	THEN	5831
WHEN dv.dataelementid =	5832	THEN	5832
WHEN dv.dataelementid =	5833	THEN	5833
WHEN dv.dataelementid =	5834	THEN	5834
WHEN dv.dataelementid =	5835	THEN	5835
WHEN dv.dataelementid =	5836	THEN	5836
WHEN dv.dataelementid =	5837	THEN	5837
WHEN dv.dataelementid =	5838	THEN	5838
WHEN dv.dataelementid =	5839	THEN	5839
WHEN dv.dataelementid =	5840	THEN	5840
WHEN dv.dataelementid =	5841	THEN	5841
WHEN dv.dataelementid =	5842	THEN	5842
WHEN dv.dataelementid =	5843	THEN	5843
WHEN dv.dataelementid =	5844	THEN	5844
WHEN dv.dataelementid =	5845	THEN	5845
WHEN dv.dataelementid =	5846	THEN	5846
WHEN dv.dataelementid =	5847	THEN	5847
WHEN dv.dataelementid =	5848	THEN	5848
WHEN dv.dataelementid =	5849	THEN	5849
WHEN dv.dataelementid =	5850	THEN	5850
WHEN dv.dataelementid =	5851	THEN	5851
WHEN dv.dataelementid =	5852	THEN	5852
WHEN dv.dataelementid =	5853	THEN	5853
WHEN dv.dataelementid =	5854	THEN	5854
WHEN dv.dataelementid =	5855	THEN	5855
WHEN dv.dataelementid =	5856	THEN	5856
WHEN dv.dataelementid =	5857	THEN	5857
WHEN dv.dataelementid =	5858	THEN	5858
WHEN dv.dataelementid =	5859	THEN	5859
WHEN dv.dataelementid =	5860	THEN	5860
WHEN dv.dataelementid =	5861	THEN	5861
WHEN dv.dataelementid =	5862	THEN	5862
WHEN dv.dataelementid =	5863	THEN	5863
WHEN dv.dataelementid =	5864	THEN	5864
WHEN dv.dataelementid =	5865	THEN	5865
WHEN dv.dataelementid =	5866	THEN	5866
WHEN dv.dataelementid =	5867	THEN	5867
WHEN dv.dataelementid =	5868	THEN	5868
WHEN dv.dataelementid =	5869	THEN	5869
WHEN dv.dataelementid =	5870	THEN	5870
WHEN dv.dataelementid =	5871	THEN	5871
WHEN dv.dataelementid =	5872	THEN	5872
WHEN dv.dataelementid =	5873	THEN	5873
WHEN dv.dataelementid =	5874	THEN	5874
WHEN dv.dataelementid =	5875	THEN	5875
WHEN dv.dataelementid =	5876	THEN	5876
WHEN dv.dataelementid =	5877	THEN	5877

END AS heading
FROM datavalue dv
INNER JOIN period p ON p.periodid=dv.periodid 
WHERE dv.dataelementid IN (3,4,5,6,7,8,9,10,11,12,13,19,20,21,25,23,24,33,36,37,38,39,40,41,42,515,516,521,522,5775,1253,1254,1256,1257,1260,
1261,5791,5792,5793,5794,5795,5796,5797,5798,5799,5800,5801,5802,5803,5813,5814,5815,5816,5817,5818,5819,5820,5821,5822,5823,5824,5825,5826,
5827,5828,5829,5830,5831,5832,5833,5834,5835,5836,5837,5838,5839,5840,5841,5842,5843,5844,5845,5846,5847,5848,5849,5850,5851,5852,5853,5854,
5855,5856,5857,5858,5859,5860,5861,5862,5863,5864,5865,5866,5867,5868,5869,5870,5871,5872,5873,5874,5875,5876,5877)
AND dv.categoryoptioncomboid IN (1)
AND p.startdate BETWEEN '2013-09-01' AND '2013-09-31'
AND periodtypeid = 3
)asd1
ON asd.organisationunitid = asd1.sourceid
)sag
)sag1