SELECT sag1.name,
SUM(IFNULL(sag1.8109_1_jan,0)) AS '8109_1_jan',
SUM(IFNULL(sag1.8110_1_jan,0)) AS '8110_1_jan',
SUM(IFNULL(sag1.8111_1_jan,0)) AS '8111_1_jan',
SUM(IFNULL(sag1.8112_1_jan,0)) AS '8112_1_jan',
SUM(IFNULL(sag1.8113_1_jan,0)) AS '8113_1_jan',
SUM(IFNULL(sag1.8114_1_jan,0)) AS '8114_1_jan',

SUM(IFNULL(sag1.8109_1_feb,0)) AS '8109_1_feb',
SUM(IFNULL(sag1.8110_1_feb,0)) AS '8110_1_feb',
SUM(IFNULL(sag1.8111_1_feb,0)) AS '8111_1_feb',
SUM(IFNULL(sag1.8112_1_feb,0)) AS '8112_1_feb',
SUM(IFNULL(sag1.8113_1_feb,0)) AS '8113_1_feb',
SUM(IFNULL(sag1.8114_1_feb,0)) AS '8114_1_feb',

SUM(IFNULL(sag1.8109_1_mar,0)) AS '8109_1_mar',
SUM(IFNULL(sag1.8110_1_mar,0)) AS '8110_1_mar',
SUM(IFNULL(sag1.8111_1_mar,0)) AS '8111_1_mar',
SUM(IFNULL(sag1.8112_1_mar,0)) AS '8112_1_mar',
SUM(IFNULL(sag1.8113_1_mar,0)) AS '8113_1_mar',
SUM(IFNULL(sag1.8114_1_mar,0)) AS '8114_1_mar',

SUM(IFNULL(sag1.8109_1_apr,0)) AS '8109_1_apr',
SUM(IFNULL(sag1.8110_1_apr,0)) AS '8110_1_apr',
SUM(IFNULL(sag1.8111_1_apr,0)) AS '8111_1_apr',
SUM(IFNULL(sag1.8112_1_apr,0)) AS '8112_1_apr',
SUM(IFNULL(sag1.8113_1_apr,0)) AS '8113_1_apr',
SUM(IFNULL(sag1.8114_1_apr,0)) AS '8114_1_apr',


SUM(IFNULL(sag1.8109_1_may,0)) AS '8109_1_may',
SUM(IFNULL(sag1.8110_1_may,0)) AS '8110_1_may',
SUM(IFNULL(sag1.8111_1_may,0)) AS '8111_1_may',
SUM(IFNULL(sag1.8112_1_may,0)) AS '8112_1_may',
SUM(IFNULL(sag1.8113_1_may,0)) AS '8113_1_may',
SUM(IFNULL(sag1.8114_1_may,0)) AS '8114_1_may',

SUM(IFNULL(sag1.8109_1_jun,0)) AS '8109_1_jun',
SUM(IFNULL(sag1.8110_1_jun,0)) AS '8110_1_jun',
SUM(IFNULL(sag1.8111_1_jun,0)) AS '8111_1_jun',
SUM(IFNULL(sag1.8112_1_jun,0)) AS '8112_1_jun',
SUM(IFNULL(sag1.8113_1_jun,0)) AS '8113_1_jun',
SUM(IFNULL(sag1.8114_1_jun,0)) AS '8114_1_jun',

SUM(IFNULL(sag1.8109_1_jul,0)) AS '8109_1_jul',
SUM(IFNULL(sag1.8110_1_jul,0)) AS '8110_1_jul',
SUM(IFNULL(sag1.8111_1_jul,0)) AS '8111_1_jul',
SUM(IFNULL(sag1.8112_1_jul,0)) AS '8112_1_jul',
SUM(IFNULL(sag1.8113_1_jul,0)) AS '8113_1_jul',
SUM(IFNULL(sag1.8114_1_jul,0)) AS '8114_1_jul',


SUM(IFNULL(sag1.8109_1_aug,0)) AS '8109_1_aug',
SUM(IFNULL(sag1.8110_1_aug,0)) AS '8110_1_aug',
SUM(IFNULL(sag1.8111_1_aug,0)) AS '8111_1_aug',
SUM(IFNULL(sag1.8112_1_aug,0)) AS '8112_1_aug',
SUM(IFNULL(sag1.8113_1_aug,0)) AS '8113_1_aug',
SUM(IFNULL(sag1.8114_1_aug,0)) AS '8114_1_aug',


SUM(IFNULL(sag1.8109_1_sep,0)) AS '8109_1_sep',
SUM(IFNULL(sag1.8110_1_sep,0)) AS '8110_1_sep',
SUM(IFNULL(sag1.8111_1_sep,0)) AS '8111_1_sep',
SUM(IFNULL(sag1.8112_1_sep,0)) AS '8112_1_sep',
SUM(IFNULL(sag1.8113_1_sep,0)) AS '8113_1_sep',
SUM(IFNULL(sag1.8114_1_sep,0)) AS '8114_1_sep',

SUM(IFNULL(sag1.8109_1_oct,0)) AS '8109_1_oct',
SUM(IFNULL(sag1.8110_1_oct,0)) AS '8110_1_oct',
SUM(IFNULL(sag1.8111_1_oct,0)) AS '8111_1_oct',
SUM(IFNULL(sag1.8112_1_oct,0)) AS '8112_1_oct',
SUM(IFNULL(sag1.8113_1_oct,0)) AS '8113_1_oct',
SUM(IFNULL(sag1.8114_1_oct,0)) AS '8114_1_oct',

SUM(IFNULL(sag1.8109_1_nov,0)) AS '8109_1_nov',
SUM(IFNULL(sag1.8110_1_nov,0)) AS '8110_1_nov',
SUM(IFNULL(sag1.8111_1_nov,0)) AS '8111_1_nov',
SUM(IFNULL(sag1.8112_1_nov,0)) AS '8112_1_nov',
SUM(IFNULL(sag1.8113_1_nov,0)) AS '8113_1_nov',
SUM(IFNULL(sag1.8114_1_nov,0)) AS '8114_1_nov',

SUM(IFNULL(sag1.8109_1_dec,0)) AS '8109_1_dec',
SUM(IFNULL(sag1.8110_1_dec,0)) AS '8110_1_dec',
SUM(IFNULL(sag1.8111_1_dec,0)) AS '8111_1_dec',
SUM(IFNULL(sag1.8112_1_dec,0)) AS '8112_1_dec',
SUM(IFNULL(sag1.8113_1_dec,0)) AS '8113_1_dec',
SUM(IFNULL(sag1.8114_1_dec,0)) AS '8114_1_dec'

FROM
(
SELECT sag.name,
CASE WHEN sag.dataelementid=8109 AND sag.month=01 THEN sag.value END AS '8109_1_jan',
CASE WHEN sag.dataelementid=8110 AND sag.month=01 THEN sag.value END AS '8110_1_jan',
CASE WHEN sag.dataelementid=8111 AND sag.month=01 THEN sag.value END AS '8111_1_jan',
CASE WHEN sag.dataelementid=8112 AND sag.month=01 THEN sag.value END AS '8112_1_jan',
CASE WHEN sag.dataelementid=8113 AND sag.month=01 THEN sag.value END AS '8113_1_jan',
CASE WHEN sag.dataelementid=8114 AND sag.month=01 THEN sag.value END AS '8114_1_jan',

CASE WHEN sag.dataelementid=8109 AND sag.month=02 THEN sag.value END AS '8109_1_feb',
CASE WHEN sag.dataelementid=8110 AND sag.month=02 THEN sag.value END AS '8110_1_feb',
CASE WHEN sag.dataelementid=8111 AND sag.month=02 THEN sag.value END AS '8111_1_feb',
CASE WHEN sag.dataelementid=8112 AND sag.month=02 THEN sag.value END AS '8112_1_feb',
CASE WHEN sag.dataelementid=8113 AND sag.month=02 THEN sag.value END AS '8113_1_feb',
CASE WHEN sag.dataelementid=8114 AND sag.month=02 THEN sag.value END AS '8114_1_feb',

CASE WHEN sag.dataelementid=8109 AND sag.month=03 THEN sag.value END AS '8109_1_mar',
CASE WHEN sag.dataelementid=8110 AND sag.month=03 THEN sag.value END AS '8110_1_mar',
CASE WHEN sag.dataelementid=8111 AND sag.month=03 THEN sag.value END AS '8111_1_mar',
CASE WHEN sag.dataelementid=8112 AND sag.month=03 THEN sag.value END AS '8112_1_mar',
CASE WHEN sag.dataelementid=8113 AND sag.month=03 THEN sag.value END AS '8113_1_mar',
CASE WHEN sag.dataelementid=8114 AND sag.month=03 THEN sag.value END AS '8114_1_mar',

CASE WHEN sag.dataelementid=8109 AND sag.month=04 THEN sag.value END AS '8109_1_apr',
CASE WHEN sag.dataelementid=8110 AND sag.month=04 THEN sag.value END AS '8110_1_apr',
CASE WHEN sag.dataelementid=8111 AND sag.month=04 THEN sag.value END AS '8111_1_apr',
CASE WHEN sag.dataelementid=8112 AND sag.month=04 THEN sag.value END AS '8112_1_apr',
CASE WHEN sag.dataelementid=8113 AND sag.month=04 THEN sag.value END AS '8113_1_apr',
CASE WHEN sag.dataelementid=8114 AND sag.month=04 THEN sag.value END AS '8114_1_apr',

CASE WHEN sag.dataelementid=8109 AND sag.month=05 THEN sag.value END AS '8109_1_may',
CASE WHEN sag.dataelementid=8110 AND sag.month=05 THEN sag.value END AS '8110_1_may',
CASE WHEN sag.dataelementid=8111 AND sag.month=05 THEN sag.value END AS '8111_1_may',
CASE WHEN sag.dataelementid=8112 AND sag.month=05 THEN sag.value END AS '8112_1_may',
CASE WHEN sag.dataelementid=8113 AND sag.month=05 THEN sag.value END AS '8113_1_may',
CASE WHEN sag.dataelementid=8114 AND sag.month=05 THEN sag.value END AS '8114_1_may',

CASE WHEN sag.dataelementid=8109 AND sag.month=06 THEN sag.value END AS '8109_1_jun',
CASE WHEN sag.dataelementid=8110 AND sag.month=06 THEN sag.value END AS '8110_1_jun',
CASE WHEN sag.dataelementid=8111 AND sag.month=06 THEN sag.value END AS '8111_1_jun',
CASE WHEN sag.dataelementid=8112 AND sag.month=06 THEN sag.value END AS '8112_1_jun',
CASE WHEN sag.dataelementid=8113 AND sag.month=06 THEN sag.value END AS '8113_1_jun',
CASE WHEN sag.dataelementid=8114 AND sag.month=06 THEN sag.value END AS '8114_1_jun',

CASE WHEN sag.dataelementid=8109 AND sag.month=07 THEN sag.value END AS '8109_1_jul',
CASE WHEN sag.dataelementid=8110 AND sag.month=07 THEN sag.value END AS '8110_1_jul',
CASE WHEN sag.dataelementid=8111 AND sag.month=07 THEN sag.value END AS '8111_1_jul',
CASE WHEN sag.dataelementid=8112 AND sag.month=07 THEN sag.value END AS '8112_1_jul',
CASE WHEN sag.dataelementid=8113 AND sag.month=07 THEN sag.value END AS '8113_1_jul',
CASE WHEN sag.dataelementid=8114 AND sag.month=07 THEN sag.value END AS '8114_1_jul',

CASE WHEN sag.dataelementid=8109 AND sag.month=08 THEN sag.value END AS '8109_1_aug',
CASE WHEN sag.dataelementid=8110 AND sag.month=08 THEN sag.value END AS '8110_1_aug',
CASE WHEN sag.dataelementid=8111 AND sag.month=08 THEN sag.value END AS '8111_1_aug',
CASE WHEN sag.dataelementid=8112 AND sag.month=08 THEN sag.value END AS '8112_1_aug',
CASE WHEN sag.dataelementid=8113 AND sag.month=08 THEN sag.value END AS '8113_1_aug',
CASE WHEN sag.dataelementid=8114 AND sag.month=08 THEN sag.value END AS '8114_1_aug',

CASE WHEN sag.dataelementid=8109 AND sag.month=09 THEN sag.value END AS '8109_1_sep',
CASE WHEN sag.dataelementid=8110 AND sag.month=09 THEN sag.value END AS '8110_1_sep',
CASE WHEN sag.dataelementid=8111 AND sag.month=09 THEN sag.value END AS '8111_1_sep',
CASE WHEN sag.dataelementid=8112 AND sag.month=09 THEN sag.value END AS '8112_1_sep',
CASE WHEN sag.dataelementid=8113 AND sag.month=09 THEN sag.value END AS '8113_1_sep',
CASE WHEN sag.dataelementid=8114 AND sag.month=09 THEN sag.value END AS '8114_1_sep',

CASE WHEN sag.dataelementid=8109 AND sag.month=10 THEN sag.value END AS '8109_1_oct',
CASE WHEN sag.dataelementid=8110 AND sag.month=10 THEN sag.value END AS '8110_1_oct',
CASE WHEN sag.dataelementid=8111 AND sag.month=10 THEN sag.value END AS '8111_1_oct',
CASE WHEN sag.dataelementid=8112 AND sag.month=10 THEN sag.value END AS '8112_1_oct',
CASE WHEN sag.dataelementid=8113 AND sag.month=10 THEN sag.value END AS '8113_1_oct',
CASE WHEN sag.dataelementid=8114 AND sag.month=10 THEN sag.value END AS '8114_1_oct',

CASE WHEN sag.dataelementid=8109 AND sag.month=11 THEN sag.value END AS '8109_1_nov',
CASE WHEN sag.dataelementid=8110 AND sag.month=11 THEN sag.value END AS '8110_1_nov',
CASE WHEN sag.dataelementid=8111 AND sag.month=11 THEN sag.value END AS '8111_1_nov',
CASE WHEN sag.dataelementid=8112 AND sag.month=11 THEN sag.value END AS '8112_1_nov',
CASE WHEN sag.dataelementid=8113 AND sag.month=11 THEN sag.value END AS '8113_1_nov',
CASE WHEN sag.dataelementid=8114 AND sag.month=11 THEN sag.value END AS '8114_1_nov',

CASE WHEN sag.dataelementid=8109 AND sag.month=12 THEN sag.value END AS '8109_1_dec',
CASE WHEN sag.dataelementid=8110 AND sag.month=12 THEN sag.value END AS '8110_1_dec',
CASE WHEN sag.dataelementid=8111 AND sag.month=12 THEN sag.value END AS '8111_1_dec',
CASE WHEN sag.dataelementid=8112 AND sag.month=12 THEN sag.value END AS '8112_1_dec',
CASE WHEN sag.dataelementid=8113 AND sag.month=12 THEN sag.value END AS '8113_1_dec',
CASE WHEN sag.dataelementid=8114 AND sag.month=12 THEN sag.value END AS '8114_1_dec'


FROM
(
SELECT asd.organisationunitid,asd.idlevel3, asd.name,asd1.dataelementid,asd1.categoryoptioncomboid,asd1.value,asd1.month
FROM
(
SELECT os.organisationunitid,os.idlevel3,og.name AS 'gname',ou.name,os.level
FROM orgunitgroupmembers ogm
INNER JOIN orgunitgroup og ON ogm.orgunitgroupid = og.orgunitgroupid
INNER JOIN _orgunitstructure os ON ogm.organisationunitid=os.organisationunitid
INNER JOIN organisationunit ou ON ou.organisationunitid = os.idlevel3
WHERE og.name IN ('CHCs','PHCs','Sub Centres','Sub District Hospitals','District Hospitals')

)asd

LEFT JOIN

(
SELECT tmp.dataelementid,tmp.categoryoptioncomboid,SUM(tmp.value) AS 'value',tmp.sourceid,tmp.Month
FROM
(
SELECT dv.dataelementid,dv.categoryoptioncomboid,dv.value,dv.sourceid,p.startdate ,MONTH(p.startdate) AS 'Month'
FROM datavalue dv
INNER JOIN period p ON p.periodid=dv.periodid 
WHERE dv.dataelementid IN (8109,8110,8111,8112,8113,8114)
AND dv.categoryoptioncomboid IN (1)
AND YEAR(p.startdate) = YEAR('2014-01-01') 
AND periodtypeid=1 
)tmp
GROUP BY tmp.dataelementid,tmp.categoryoptioncomboid,tmp.sourceid,tmp.Month
)asd1

ON asd.organisationunitid = asd1.sourceid
)sag
)sag1

GROUP BY sag1.name